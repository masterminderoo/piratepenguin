<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta property="og:title" content="Pirate Penguin Budapest ‚Äì A Social Deduction Treasure Hunt" />
  <meta property="og:description" content="Solve riddles, deceive your teammates, and outwit traitors in this hidden role adventure game!" />
  <meta property="og:url" content="https://piratepenguinbudapest.com" />
  <meta property="og:type" content="website" />
  <link rel="icon" href="./penguicon.png" type="image/png" />
  <title>Pirate Penguin Budapest</title>

  <script>
  (function() {
    // Pr√ºfen, ob der automatische Check schon durchgef√ºhrt wurde
    if (!sessionStorage.getItem('firstVisitDone')) {
      const userLang = navigator.language || navigator.userLanguage;
      if(userLang && userLang.toLowerCase().startsWith('de')) {
        // Weiterleiten auf Deutsch, wenn Browser-Sprache deutsch ist
        if(!window.location.pathname.includes('index-de.html')) {
          // Automatischen Check als erledigt markieren
          sessionStorage.setItem('firstVisitDone', 'true');
          window.location.href = 'index-de.html' + window.location.search;
          return; // wichtig, um weiteren Code zu stoppen
        }
      }
      // Automatischen Check als erledigt markieren, wenn keine Weiterleitung n√∂tig
      sessionStorage.setItem('firstVisitDone', 'true');
    }
  })();
</script>

  <style>
    body { font-family: Arial, sans-serif; margin: 0; background: #fefefe; color: white; }
    header { background: #222; color: white; padding: 1.5rem; text-align: center; }
    header h1 { margin: 0; font-size: 2rem; }
    header p { margin: 0.5rem 0 0; font-size: 1.2rem; }
    .section { padding: 2rem 1rem; max-width: 800px; margin: auto; }
    .highlight { background: #f4f4f4; border-left: 5px solid #222; padding: 1rem; margin: 1rem 0; }
    .tour-info td { padding: 0.5rem; }
    .cta-button { background: #222; color: white; padding: 1rem 2rem; border: none; font-size: 1rem; cursor: pointer; display: block; margin: 2rem auto; text-decoration: none; text-align: center; width: fit-content; border-radius: 5px; }
    footer { text-align: center; padding: 1rem; font-size: 0.9rem; color: #666; }
    .calendar-container { text-align: center; }
    .calendar { border-collapse: collapse; margin: 0 auto; font-size: 1rem; }
    .calendar th, .calendar td { width: 30px; height: 30px; text-align: center; border: 1px solid #ddd; }
    .calendar th { background-color: #222; color: white; }
    .calendar td { cursor: pointer; padding: 10px; }
    .calendar td:hover { background-color: #f4f4f4; }
    .language-switcher {display: flex; gap: 35px; justify-content: center; align-items: center;}
    .flag-icon {  border-radius: 4px;}
    .flag-icon.selected { border:2px solid gold; }
  </style>
</head>
<body>
  <header>
    <img src="./piratepengulogosmall.png" alt="Pirate Penguin Logo" style="width: 350px; height: auto;" />
    <h1>Urban Social Deduction Game</h1>
    <p>Discover Budapest's Hidden Treasure</p>
  </header>

      <link rel="stylesheet" href="css/style.css" />

  <section class="section">
    <div class="language-switcher">
    <a href="index.html"><img src="./flag-uk.png" alt="English" width="48" height=auto class="flag-icon selected"></a>
    <a href="index-de.html"><img src="./flag-de.png" alt="Deutsch" width="48" height=auto class="flag-icon"></a>
    </div>
    <h2>What To Expect</h2>
    <p>I'm not your guide - I'm your Captain! Pirate Penguin is a <strong>live-action hidden role game</strong> across Budapest's wildest districts,
      but beware: Not every crewmate is on your side...</p>
    <p>You and your fellow adventurers are each given a <strong>secret role</strong> with bizarre rules and hidden goals, and it's up to you to figure out
    who's behaving strangely - and why. Can you solve the puzzles of the Treasure Hunt without getting distracted by the other roles?</p>
    <p>Whether you're here to <strong>solve the mystery</strong>, <strong>embrace the chaos</strong>, or just <strong>mess with your friends</strong>, 
      Pirate Penguin is an experience you'll never forget!</p>
    <div class="highlight">
      <ul>
        <p>‚öì No scripted lectures. No boring history lessons. Just pure adventure, hosted by a Penguin Game Master</p>
        <p>üêß Solve puzzles, crack codes, and discover secret locations across Budapest</p>
        <p>üè¥‚Äç‚ò†Ô∏è Outwit traitors, expose hidden roles, and claim the treasure before the Kraken finds you</p>
      </ul>
    </div>
  </section>

  <section class="section">
    <h2>Role or Ruse?</h2>
    <img src="./piratepenguinroles.jpg" alt="City Highlights" style="width: 800px; height: auto;">
    <p>Is David whispering to a lamppost because he's <strong>The Haunted Sailor</strong>, or is he just a bit weird? Is Maria dramatically narrating 
      everything because she is <strong>The Storyteller</strong>, or does she really always talk like that? You won't know until the big reveal at the 
      end of the game, but it will be hilarious nonetheless!</p> 
    <p>Shortly before the game starts, the Game Master will handpick a role for you from a list of <strong>over 50 roles</strong>, ensuring it goes well with the
    other roles he's planning to include in this session. You will receive an email with your role card, a short explanation about your ability/goal, and some tips
    and tricks on how to play your specific role.</p>
    <img src="./ppromo.jpg" alt="City Highlights" style="width: 500px; height: auto; border-radius: 5px;">
  </section>


 <section class="section">
  <h2>Choose Your Cruise</h2>
  <div class="gallery">
    <div class="gallery-item" onclick="updateDetails('tour1')">
      <img src="./piratepengulangos.jpg" alt="City Highlights" style="width: 280px; height: auto;">
      <div class="overlay">Food & Loot</div>
    </div>
    <div class="gallery-item" onclick="updateDetails('tour2')">
      <img src="./piratepenguboardgame.jpg" alt="Food & Culture" style="width: 280px; height: auto;">
      <div class="overlay">Games & Plunder</div>
    </div>
    <div class="gallery-item" onclick="updateDetails('tour3')">
      <img src="./piratepenguboat.jpg" alt="Hidden Gems" style="width: 280px; height: auto;">
      <div class="overlay">Private Voyage</div>
    </div>
  </div>
</section>

<!-- Dynamic Details Section -->
<section class="section">
  <h2></h2>
  <div id="details">
    <p>Click on a picture to see details.</p>
  </div>
    <button id="backButton" onclick="resetDetails()" style="display: none;">Back to Events</button>
</section>


  <section class="section">
    <h2>All Aboard!</h2>
    <p>Select a date to reserve your spot:</p>
    <div class="calendar-container">
      <table class="calendar">
        <thead>
        </thead>
        <tbody>
        </tbody>
      </table>
    </div>
    <div id="booking-form" style="display: none; margin-top: 20px; background: #fff; color: black; padding: 20px; border-radius: 8px; max-width: 500px; margin-left: auto; margin-right: auto;">
  <h3>Reserve Your Spot</h3>
  <h3 id="selected-date"></h3>
  <form action="https://formsubmit.co/captain@piratepenguinbudapest.com" method="POST">
    <input type="hidden" name="referrer" id="refInput">
    <script>
    document.getElementById("refInput").value = sessionStorage.getItem("ref") || '';
    </script>
    <input type="hidden" name="_captcha" value="false">
    <input type="hidden" name="tour_date" id="form-date">
    <label for="name">Name:</label><br>
    <input type="text" id="name" name="name" required><br><br>

    <label for="email">Email:</label><br>
    <input type="email" id="email" name="email" required><br><br>

    <label for="participants">Number of participants:</label><br>
    <input type="number" id="participants" name="participants" min="1" max="5" value="1" required><br><br>

    <label>
    <input type="checkbox" id="cashOption" name="cashOption">
    I want to pay in cash at the start of the event (+1000Ft/3‚Ç¨ reservation fee)
    </label>

    <div id="priceSummary" class="price-summary" style="margin-top: 15px; font-weight: bold;">
    <!-- Dynamischer Preis wird hier eingef√ºgt -->
    </div>

    <button type="submit" class="cta-button">Book Now</button>

    <input type="hidden" name="_next" id="redirect-url">

  </form>
</div>

  </section>

<script>

  const params = new URLSearchParams(window.location.search);
  const ref = params.get("ref");
  if (ref) {
    sessionStorage.setItem("ref", ref);
  }
  
  function formatDate(dateString) {
    const date = new Date(dateString);
    const options = { weekday: 'long', day: '2-digit', month: '2-digit', year: 'numeric' };
    return date.toLocaleDateString('en-GB', options).replace(/\//g, '.');
  }

  let expandedRow = null;

  async function fetchBookings() {
    const apiUrl = 'https://script.google.com/macros/s/AKfycby1BI5Bf1kFrGzWV86K8-5uCQaIvfAChptNfsL0jQMPnL143TZqnFFEiO7yWNei7oU7/exec';

    try {
      const response = await fetch(apiUrl);
      const data = await response.json();
      const calendar = document.querySelector('.calendar');

      // Create table headers
      const headers = `
        <thead>
          <tr>
            <th class="header-gold">Date</th>
            <th class="header-gold">Script</th>
            <th class="header-gold">Start Time</th>
            <th class="header-gold">Spots Left</th>
          </tr>
        </thead>
        <tbody></tbody>`;
      calendar.innerHTML = headers;

      const tbody = calendar.querySelector('tbody');

      data.forEach((row, index) => {
        const formattedDate = formatDate(row.date);
        const isFull = parseInt(row.spotsLeft) === 0;
        const spotsLeftStyle = isFull ? 'style="background-color: #B22222; color: white; font-weight: bold;"' : '';
        const bgColor = index % 2 === 0 ? '#8B4513' : '#A0522D';

        const tr = document.createElement('tr');
        tr.style.backgroundColor = bgColor;
        tr.innerHTML = `
          <td>${formattedDate}</td>
          <td>${row.tourName}</td>
          <td>${row.participants}</td>
          <td ${spotsLeftStyle}>${row.spotsLeft}</td>
        `;

  if (parseInt(row.spotsLeft) > 0) {
  tr.addEventListener('click', () => {
  // Vorherige erweiterte Zeile oder Formular ausblenden
  if (expandedRow && expandedRow.parentNode) {
    expandedRow.parentNode.removeChild(expandedRow);
    if (expandedRow.previousSibling === tr) {
      expandedRow = null;
      // Formular ausblenden, wenn dasselbe Datum nochmal geklickt wird
      const bookingForm = document.getElementById('booking-form');
      if (bookingForm) bookingForm.style.display = 'none';
      return;
    }
  }

  
  // Formular anzeigen und mit Datum f√ºllen
  const bookingForm = document.getElementById('booking-form');
  if (bookingForm) {
    bookingForm.style.display = 'block';
    updatePriceSummary();

    // Datum formatieren und anzeigen
    const formattedDate = formatDate(row.date);
    const selectedDateEl = document.getElementById('selected-date');
    if (selectedDateEl) selectedDateEl.textContent = `You selected: ${formattedDate}`;

    const formDateInput = document.getElementById('form-date');
    if (formDateInput) formDateInput.value = row.date; // rohes Datum ins Hidden-Feld

    bookingForm.scrollIntoView({ behavior: 'smooth' });
  }
        });
  } else {
  tr.title = "This event is fully booked";
  tr.addEventListener('click', () => {
    // Find the Start Time cell in this row (3rd cell, index 2)
    const startTimeCell = tr.cells[2];
    if (startTimeCell) {
      // Toggle the text between original and custom message
      if (startTimeCell.dataset.originalText === undefined) {
        // Save original text in a data attribute
        startTimeCell.dataset.originalText = startTimeCell.textContent;
      }

      if (startTimeCell.textContent !== "Fully booked") {
        startTimeCell.textContent = "Fully booked";
      } else {
        // Toggle back to original
        startTimeCell.textContent = startTimeCell.dataset.originalText;
      }
    }
  });
}

        tbody.appendChild(tr);
      });
    } catch (error) {
      console.error('Error fetching data:', error);
    }
  }

  window.onload = fetchBookings;

      function updatePriceSummary() {
  const numParticipants = parseInt(document.getElementById('participants').value) || 1;
  const cashSelected = document.getElementById('cashOption').checked;

  const basePrice = numParticipants * 8000;
  const cashFee = cashSelected ? 1000 : 0;
  const total = basePrice + cashFee;

  const priceHTML = `
    <div>Base price: 8000Ft x ${numParticipants} = <strong>${basePrice}‚ÄØFt</strong></div>
    ${cashSelected ? `<div>Reservation fee: <strong>+1000‚ÄØFt</strong></div>` : ''}
    <div style="margin-top: 5px;">Total: <strong>${total}‚ÄØFt</strong></div>
  `;

  document.getElementById('priceSummary').innerHTML = priceHTML;
}

  // Preis automatisch aktualisieren, wenn Teilnehmerzahl oder Checkbox ge√§ndert wird
document.addEventListener('DOMContentLoaded', () => {
  const participantsInput = document.getElementById('participants');
  const cashCheckbox = document.getElementById('cashOption');

  if (participantsInput) {
    participantsInput.addEventListener('input', updatePriceSummary);
  }

  if (cashCheckbox) {
    cashCheckbox.addEventListener('change', updatePriceSummary);
  }
});

   const form = document.getElementById("booking-form");

  document.querySelector("form").addEventListener("submit", function (e) {
    const form = e.target;
    const date = document.getElementById("form-date").value;
    const participants = document.getElementById("participants").value;
    const webhookUrl = "https://script.google.com/macros/s/AKfycby1BI5Bf1kFrGzWV86K8-5uCQaIvfAChptNfsL0jQMPnL143TZqnFFEiO7yWNei7oU7/exec";

    fetch(webhookUrl, {
      method: "POST",
      headers: { "Content-Type": "application/x-www-form-urlencoded" },
      body: `tour_date=${encodeURIComponent(date)}&participants=${encodeURIComponent(participants)}`
    }).then(response => {
      // Optional: Log oder Best√§tigung
      console.log("Webhook request sent");
    }).catch(error => {
      console.error("Error updating spotsLeft:", error);
    });
  });

  
  form.addEventListener("submit", function(event) {
    const cashOptionChecked = document.getElementById("cashOption").checked;
    const participants = parseInt(document.getElementById("participants").value, 10);

    // Redirect-URLs je nach Zahlungsmethode
    const redirectUrl = cashOptionChecked
      ? "https://piratepenguinbudapest.com/thanks-cash.html"
      : "https://piratepenguinbudapest.com/thanks-online.html";

    // Setze Redirect-URL dynamisch
    document.getElementById("redirect-url").value = redirectUrl;

    // Nur wenn NICHT Barzahlung gew√§hlt wurde, soll der Revolut-Link aufgehen
    if (!cashOptionChecked) {
      const revolutLinks = {
        1: "https://checkout.revolut.com/pay/abbc46b6-05a2-499f-8126-69831c81ceb0",
        2: "https://checkout.revolut.com/pay/c41aa667-ca4a-47b5-a6b6-478dbd4f24ae",
        3: "https://checkout.revolut.com/pay/1cb6b13e-0998-40ac-b2ac-eced4b187353",
        4: "https://checkout.revolut.com/pay/090633d9-e500-4b92-a1fa-08eab50c3985",
        5: "https://checkout.revolut.com/pay/88a688ca-7ec2-4a50-bbab-dea8bbc56a34"
      };

      const payLink = revolutLinks[participants];
      if (payLink) {
        window.open(payLink, "_blank");
      }
    }

    // Formular wird wie gewohnt weitergesendet
  });
</script>

 
  <section class="section">
    <h2>Frequently Asked Questions</h2>
    <div class="highlight">
      <ul>
  <p><strong>Is prior experience with treasure hunts or social deduction games required?</strong><br>
      Not at all! Whether you‚Äôre a seasoned pirate or a sailor new to the game, 
      everyone is welcome. I‚Äôll explain the rules clearly before we start and you can always ask me questions during the game.</p>
  <p><strong>What if I don't like the role I get?</strong><br>
  I may be a pirate who mutinied another captain once (the sharks had a feast that day), but I am not heartless. 
  If you don't like your role, please send me an email <strong>before the game starts</strong>, and we will find a solution together 
    (in most cases, you will get another role).</p>

  <p><strong>What if it's raining on the day of the game? Will the game be cancelled / postponed?</strong><br>
  Arrrr, what do you take me for, a landlubber?! A real pirate navigates his ship through the wildest of storms, so we will play the game just as planned 
    even if there's a little rain. That said, if it's raining so much that Noah starts building an Ark again, I will cancel the event and fully refund 
    every participant.</p>

  <p><strong>What currencies do you accept?</strong><br>
  You can pay in either Hungarian Forint(online or cash) or Euro (cash only).</p>

  <p><strong>Can I bring my own food and drinks?</strong><br>
  Yes, of course! While we will be in an area with many options to buy food and drinks, you are free to bring your own. 
    Just keep in mind that the Hungarian law forbids the consumption of alcoholic beverages outside, so please only bring non-alcoholic drinks.</p>

  <p><strong>What language will be spoken during the event?</strong><br>
  Most of the events are in English, but 1-2 times a month I am also hosting a German session! If (German) or (Deutsch) is written next to the event in the 
    calendar, the event will be in German. If not, the event will be in English.</p>
      </ul>
    </div>
  </section>
  
  <footer>
    <p>&copy; 2025 Pirate Penguin Budapest</p>
    <a href="./terms-of-service.html">Terms of Service</a> | 
    <a href="./privacy-policy.html">Privacy Policy</a> |
    <a href="./imprint.html">Imprint</a>
  </footer>
  
  <script>
  const tours = {
    tour1: {
      title: "Food & Loot",
      description: "Claim the treasure buried in the 5th District and feast on food-related riddles! Eating between riddles is optional.",
      price: "8.000 HUF (20‚Ç¨) per person",
      duration: "2.5 hours",
      language: "Szent Istvan Ter 1 (in front of the Basilika)",
      ideal: "First Time Players, Food Enjoyers, Individuals, Small Friend Groups"
    },
    tour2: {
      title: "Games & Plunder",
      description: "Solve various puzzles in the 6th District and find the treasure in a board game bar! Board game tickets are included in the price.",
      price: "10.000 HUF (25‚Ç¨) per person",
      duration: "3 hours",
      language: "Andrassy Utca 22 (in front of the Opera)",
      ideal: "Board Game Fans, Video Game Fans, People that like to go off the beaten path"
    },
    tour3: {
      title: "Private Voyage",
      description: "Do you want to be just among yourselves, without anyone else joining? Or do you want the Captain to visit your home so he can turn your birthday into a social deduction party? Well, you're in luck! Get a tailored experience just for you with this private package.",
      price: "Individual pricing depending on duration and group size",
      duration: "You decide!",
      language: "5th, 6th, 7th, 8th or 13th District",
      ideal: "Families, Big Friend Groups, People who wait until the last moment to plan their party (looking at you Michael)"
    }
  };

 // Function to update details dynamically and scroll to the details section
function updateDetails(tour) {
  const details = document.getElementById("details");
  const backButton = document.getElementById("backButton");
  const detailsSection = document.querySelector('.section:nth-of-type(4)'); // The section containing details
  
  // Change content dynamically
  details.innerHTML = `
    <h2>${tours[tour].title}</h2>
    <p>${tours[tour].description}</p>
    <p><strong>Price:</strong> ${tours[tour].price}</p>
    <p><strong>Duration:</strong> ${tours[tour].duration}</p>
    <p><strong>Location:</strong> ${tours[tour].language}</p>
    <p><strong>Ideal For:</strong> ${tours[tour].ideal}</p>
    
    
  `;
  
  // Show details with smooth fade-in
  details.classList.add("show");

  // Show the back button
  backButton.style.display = "inline-block";

  // Scroll to the details section with smooth scrolling
  detailsSection.scrollIntoView({ behavior: 'smooth' });
}

// Function to reset details and hide them, then scroll back to the tours gallery
function resetDetails() {
  const details = document.getElementById("details");
  const backButton = document.getElementById("backButton");
  const gallerySection = document.querySelector('.section:nth-of-type(3)'); // The section containing the gallery
  
  // Reset content to default message
  details.innerHTML = `<p>Select a tour to see the details.</p>`;
  
  // Hide details and back button with fade-out effect
  details.classList.remove("show");
  backButton.style.display = "none";

  // Scroll back to the gallery section with smooth scrolling
  gallerySection.scrollIntoView({ behavior: 'smooth' });
}
</script>
</body>
</html>
